<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sertifikat Digital - Study Ekskursi DutaTV</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Inter (sans-serif) & Cormorant Garamond (serif for elegance) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600;700&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Animate On Scroll (AOS) for soft animations -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <style>
        /* Custom font styles */
        body {
            font-family: 'Inter', sans-serif;
        }
        .font-serif-elegant {
            font-family: 'Cormorant Garamond', serif;
        }
        /* Custom theme color */
        .maroon-text { color: #800000; }
        .maroon-border { border-color: #800000; }
        .maroon-bg { background-color: #800000; }

        /* Style for download buttons to not be included in the downloaded image */
        @media print {
            .no-print {
                display: none;
            }
        }
        .no-capture {
            /* This class will be used by html2canvas to ignore elements */
        }
    </style>
</head>
<body class="bg-gray-100 dark:bg-gray-900 text-gray-800 dark:text-gray-200 p-4 sm:p-8 flex flex-col items-center justify-center min-h-screen">

    <!-- Container for the certificate and download buttons -->
    <div class="w-full max-w-5xl">
        
        <!-- Certificate Section -->
        <div id="sertifikat" class="bg-white text-black shadow-2xl rounded-lg p-6 md:p-10 relative overflow-hidden" style="background-color: #ffffff;">
            <!-- Decorative border elements -->
            <div class="absolute top-0 left-0 w-1/3 h-1.5 maroon-bg"></div>
            <div class="absolute bottom-0 right-0 w-1/3 h-1.5 maroon-bg"></div>
            <div class="absolute top-0 left-0 w-1.5 h-1/3 maroon-bg"></div>
            <div class="absolute bottom-0 right-0 w-1.5 h-1/3 maroon-bg"></div>
            
            <div class="border-2 maroon-border p-6 md:p-8 rounded-md relative">
                <!-- Header -->
                <header class="text-center mb-6" data-aos="fade-down">
                    <img src="https://lh3.googleusercontent.com/d/1Y-ILpSFs_iOlCVaYKv1kJtiHZ7w_Oaqy" alt="Logo Penyelenggara" class="mx-auto h-20 w-auto mb-4" onerror="this.style.display='none'">
                    <h1 class="font-serif-elegant text-4xl md:text-5xl font-bold maroon-text tracking-wider">SERTIFIKAT</h1>
                    <p class="text-gray-600 mt-2">Nomor: 001-HMJI/01</p>
                </header>

                <!-- Main Content -->
                <main class="text-center my-8" data-aos="fade-up" data-aos-delay="200">
                    <p class="text-lg text-gray-700 mb-2">Dengan ini diberikan kepada:</p>
                    <h2 class="font-serif-elegant text-4xl md:text-6xl font-bold text-gray-900 my-4">Marliana</h2>
                    <p class="text-base md:text-lg max-w-3xl mx-auto text-gray-600">
                        Sebagai Peserta dalam kegiatan <strong class="font-semibold text-gray-800">"Study Ekskursi Di DutaTV"</strong>,
                        yang diselenggarakan pada tanggal 16 Juli 2025 di DutaTV.
                    </p>
                    <p class="text-sm italic text-gray-500 mt-6">"Semoga ilmu yang diberikan bisa berdampak dan bermanfaat"</p>
                </main>

                <!-- Signature Section -->
                <footer class="mt-10" data-aos="fade-up" data-aos-delay="400">
                    <div class="flex flex-col sm:flex-row justify-around items-center text-center">
                        <!-- Penyelenggara -->
                        <div class="w-full sm:w-1/3 mb-8 sm:mb-0">
                            <p class="font-semibold">Penyelenggara</p>
                            <div class="h-20 flex items-center justify-center">
                                <!-- Signature placeholder if needed -->
                            </div>
                            <p class="font-bold underline mt-2">Muhammad Nursandi</p>
                            <p class="text-sm">Ketua Pelaksana</p>
                        </div>

                        <!-- Penandatangan -->
                        <div class="w-full sm:w-1/3">
                            <p class="font-semibold">Banjarmasin, 16 Juli 2025</p>
                            <p class="font-semibold">Mengetahui,</p>
                            <div class="h-20 flex items-center justify-center">
                                <img src="https://lh3.googleusercontent.com/d/1X235t3fPjGS80wNDxu1tZ2s-w7hkQXHA" alt="Tanda Tangan" class="h-16" onerror="this.style.display='none'">
                            </div>
                            <p class="font-bold underline mt-2">Abdul Latif</p>
                            <p class="text-sm">Dosen Kemahasiswaan</p>
                            <p class="text-xs">NIP: 11203362410123</p>
                        </div>
                    </div>
                </footer>
                
                <!-- Closing Quote -->
                <div class="text-center mt-8 pt-4 border-t border-gray-200" data-aos="fade-up" data-aos-delay="500">
                    <p class="text-xs italic text-gray-500">"Terimakasih kepada seluruh peserta yang sudah mengikuti SE"</p>
                </div>
            </div>
        </div>

        <!-- Download Buttons -->
        <div class="no-print no-capture mt-8 text-center" data-aos="fade-up" data-aos-delay="600">
            <button id="download-png" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-transform transform hover:scale-105 mr-4">
                Unduh sebagai PNG
            </button>
            <button id="download-pdf" class="bg-red-700 hover:bg-red-800 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-transform transform hover:scale-105">
                Unduh sebagai PDF
            </button>
        </div>
    </div>

    <!-- JavaScript Libraries -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <script>
        // Initialize Animate On Scroll
        AOS.init({
            duration: 800,
            once: true,
        });

        // Get elements
        const certificateElement = document.getElementById('sertifikat');
        const downloadPngButton = document.getElementById('download-png');
        const downloadPdfButton = document.getElementById('download-pdf');
        const participantName = "Marliana"; // Used for filename

        // Function to handle download PNG
        downloadPngButton.addEventListener('click', () => {
            html2canvas(certificateElement, {
                scale: 2, // Increase scale for better quality
                useCORS: true, // Important for external images
                logging: true,
                onclone: (document) => {
                    // This can be used to modify the cloned document before rendering
                }
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `Sertifikat-${participantName}.png`;
                link.href = canvas.toDataURL('image/png');
                link.click();
            }).catch(err => {
                console.error("Error generating PNG:", err);
                alert("Gagal membuat gambar. Coba lagi atau periksa konsol untuk error.");
            });
        });

        // Function to handle download PDF
        downloadPdfButton.addEventListener('click', () => {
            const { jsPDF } = window.jspdf;
            
            html2canvas(certificateElement, {
                scale: 2,
                useCORS: true,
                logging: true,
            }).then(canvas => {
                const imgData = canvas.toDataURL('image/png');
                const imgWidth = canvas.width;
                const imgHeight = canvas.height;
                
                // Determine orientation based on aspect ratio
                const orientation = imgWidth > imgHeight ? 'l' : 'p'; // landscape or portrait
                
                // Create PDF with dimensions matching the canvas to avoid distortion
                const pdf = new jsPDF({
                    orientation: orientation,
                    unit: 'px',
                    format: [imgWidth, imgHeight]
                });

                pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);
                pdf.save(`Sertifikat-${participantName}.pdf`);
            }).catch(err => {
                console.error("Error generating PDF:", err);
                alert("Gagal membuat PDF. Coba lagi atau periksa konsol untuk error.");
            });
        });
    </script>

</body>
</html>
